source("./strain_transition_heatmap.r")
?load
mm
multi_mm
multi_mm_profile
multi_mm_profile
do.call(cbind, multi_mm)
source
source("./strain_transition_heatmap.r")
source("./strain_transition_heatmap.r")
limits <- range(transition_ratio_heatmap$ratio)
midpoint <- mean(limits)
ggplot(transition_ratio_heatmap, aes(ref1, ref2)) +
  geom_raster(aes(fill = ratio)) + 
  scale_fill_gradient2(low="navy", mid="white", high="red", midpoint=midpoint, limits=limits) + 
  theme_bw(base_size = 12) + 
  theme(axis.text.x = element_text(angle=70, vjust=0.5))
ggsave("ecoli.30.transition.mutation.ratio.heatmap.pdf", width=12, height=12)
getwd()
write.table(transition_ratio_heatmap, "./ecoli.30.transition_ratio.txt", sep="\t", quote=F)
write.table(multi_mm_profile, "./ecoli.30.mutationcontext.profile.txt", sep="\t", quote=F)
q()
